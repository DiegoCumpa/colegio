{% extends "page.html" %}

{% block titulo %}
    <h1>{{ form.title.label }}
        <small>Módulo de Facturación</small>
    </h1>
{% endblock %}

{% block container %}

<div class="row">
    <div class="col-md-12">
        <div class="box box-primary">
            <div class="box-body">

                <script type="text/javascript">
                    function enviarTelefono() {
                        var cadena = "";
                        var sw = true;
                        $('input[name^="nros"]').each( function() {

                            this.remove();

                        });

                        $('input[name^="telefono"]').each( function() {

                                if (!sw) {
                                    cadena += ","
                                }else{
                                    sw = false
                                }

                                cadena += this.value;
                            });

                        $('<input hidden/>').attr({ type: 'text', name: 'nros', value: cadena}).appendTo('#registro');
                    }
                    function agregarTelefono()
                    {
                        var telefono = $('#id_celular').val();
                        var sw = true;
                        if(telefono){
                            $("#id_celulares").find("> option").each(function() {
                                if(telefono == this.value)
                                    sw = false;
                            });
                        }
                        if(sw && telefono){
                            $('#id_celulares').append("<option value=" + telefono + ">" + telefono + "</option>");
                        }

                        $('#id_celular').val("");

                        $('<input hidden/>').attr({ type: 'text', name: 'telefono[]', value: telefono}).appendTo('#registro');
                    }

                    function eliminarTelefono()
                    {
                        $('#id_celulares').find('> :selected').each(function() {
                            var telefono = this.value;
                            $(this).remove();
                            $('input[name^="telefono"]').each( function() {

                                if (telefono == this.value){
                                    this.remove();
                                }

                            });
                        });
                    }

                    function seleccionarMultiselect() {
                        $('#id_celulares option').prop('selected', true);

                    }


                </script>
                        {% if form.errors %}
                            {% for field in form %}
                                {% for error in field.errors %}
                                    <div class="alert alert-danger">
                                        <strong>{{ error|escape }}</strong>
                                    </div>
                                {% endfor %}
                            {% endfor %}
                            {% for error in form.non_field_errors %}
                                <div class="alert alert-danger">
                                    <strong>{{ error|escape }}</strong>
                                </div>
                            {% endfor %}
                        {% endif %}

                        <form id="registro" name="registro" action="" method="POST" class="form-horizontal">
                            {% csrf_token %}

                            <!-- DATOS PERSONALES -->
                            <div class="col-md-9">
                                <div class="box-header with-border">
                                    <h3 class="box-title">Datos Personales</h3>
                                </div>
                                <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label class="col-sm-5 control-label">Nombre</label>
                                                <div class="col-sm-7">
                                                {{ form.nombre }}
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="col-sm-5 control-label">Apellido Paterno</label>
                                                <div class="col-sm-7">
                                                {{ form.apellido_pa }}
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="col-sm-5 control-label">Tipo de Documento</label>
                                                <div class="col-sm-7">
                                                {{ form.tipo_documento }}
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="col-sm-5 control-label">Número de Documento</label>
                                                <div class="col-sm-7">
                                                {{ form.numero_documento }}
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="col-sm-5 control-label">Correo</label>
                                                <div class="col-sm-7">
                                                {{ form.correo }}
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label class="col-sm-5 control-label">Segundo Nombre</label>
                                                <div class="col-sm-7">
                                                    {{ form.segundo_nombre }}
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="col-sm-5 control-label">Apellido Paterno</label>
                                                <div class="col-sm-7">
                                                    {{ form.apellido_pa }}
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="col-sm-5 control-label">Sexo</label>
                                                <div class="col-sm-7">
                                                    {{ form.sexo }}
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="col-sm-5 control-label">Fecha Nacimiento</label>
                                                <div class="col-sm-7">
                                                    <div class="input-group input-group-sm">
                                                        {{ form.fecha_nac }}
                                                        <span class="input-group-btn">
                                                            <button class="btn btn-default">
                                                                <i class="fa fa-calendar" aria-hidden="true"></i>
                                                            </button>
                                                        </span>
                                                    </div>
                                                </div>
                                            </div>


                                            <div class="form-group">
                                                <!-- atributo parentesco sólo para el apoderado -->
                                                {% if form.parentesco %}
                                                    <label class="col-sm-5 control-label">Parentesco</label>
                                                    <div class="col-sm-7">
                                                        {{ form.parentesco }}
                                                    </div>
                                                {% endif %}

                                            </div>

                                        </div>
                                    </div>
                            </div>

                            <!-- DATOS DE CONTACTO -->
                            <div class="col-md-9">
                                <div class="box-header with-border">
                                    <h3 class="box-title">Datos Contacto</h3>
                                </div>
                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="form-group">
                                            <label class="col-sm-3 control-label">Dirección</label>
                                            <div class="col-sm-9">
                                                {{ form.direccion }}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="form-group">
                                            <label class="col-sm-3 control-label">Referencia</label>
                                            <div class="col-sm-9">
                                                {{ form.referencia }}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label class="col-sm-5 control-label">Departamento</label>
                                            <div class="col-sm-7">
                                                {{ form.departamento }}
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label class="col-sm-5 control-label">Provincia</label>
                                            <div class="col-sm-7">
                                                {{ form.provincia }}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label class="col-sm-5 control-label">Distrito</label>
                                            <div class="col-sm-7">
                                                {{ form.distrito }}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label class="col-sm-5 control-label">Tipo Teléfono</label>
                                            <div class="col-sm-7">
                                                {{ form.tipo_cel }}
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <div class="col-sm-12">
                                                {{ form.celular }}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label class="col-sm-5 control-label"></label>
                                            <div class="col-sm-7">
                                                {{ form.celulares }}
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <div class="col-sm-12">
                                                <button type="button" class="btn btn-primary" name="agregartelefono" id="agregartelefono" onclick="agregarTelefono()">
                                                    <i class="glyphicon glyphicon-plus-sign" aria-hidden="true">
                                                        Agregar
                                                    </i>
                                                </button>
                                                <button type="button" class="btn btn-primary" name="quitartelefono" id="quitartelefono" onclick="eliminarTelefono()">
                                                    <i class="glyphicon glyphicon-remove-sign" aria-hidden="true">
                                                        Quitar
                                                    </i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-6 col-md-offset-3">
                                        <button type="reset" class="btn btn-primary">
                                            <i class="glyphicon glyphicon-remove-sign" aria-hidden="true">
                                                Cancelar
                                            </i>
                                        </button>
                                        <button type="submit" class="btn btn-primary"  onclick="enviarTelefono()">
                                            <i class="glyphicon glyphicon-plus-sign" aria-hidden="true">
                                                Agregar
                                            </i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </form>
            </div>
        </div>
    </div>
</div>

{% endblock container %}